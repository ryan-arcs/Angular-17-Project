<div class="main-manage-roles">
  <div class="breadcrumbs-outer">
    <ul>
      <li><a (click)="navigateToUsers()" class="label medium"> Users </a></li>
      <li><span>/</span></li>
      <li class="label medium">{{userId ? userName + ' &nbsp;&nbsp;/&nbsp;&nbsp; Edit' : 'Add'}}
      </li>
    </ul>
  </div>


  <div class="application-container">
    <div>
      <div class="subheader-container">
        <div class="top-container ">
          <div class="heading">
            <button class="d-btn d-btn--circle sm white-bg-circle _cp">
              <span (click)="navigateToUsers()" class="res-menu-btn-hide back-button icon-leftarrow icon--sm">
              </span>
              <!-- {{userId ? 'Edit' : 'Add'}} -->
            </button>
            <div class="application-text">
              <h2>User</h2>
            </div>
          </div>

          <div class="right">
            <button class="d-btn d-btn--secondary sm" (click)="navigateToUsers()" type="button">
              <span class="material-symbols-outlined btn-icon">close</span>
              <p class=""> Cancel</p>
            </button>
            <button class="d-btn d-btn--primary sm" type="submit" (click)="onSubmit()">
              <span class="material-symbols-outlined btn-icon">check</span>
              <p class=""> Save</p>
            </button>
          </div>
        </div>

      </div>

      <div class="main-box">
        <div class="filled-important-div">
          <p class="small">Fields marked with &nbsp;<span class="required">*</span>&nbsp; are required.</p>
        </div>
        <form [formGroup]="userEditForm">

          <!-- open close class for toggle accordian -->
          <div class="outer-box accordian-box-wrapper">
            <div class="heading-wrapper">
              <!-- <span class="icon-Vector-Stroke-15"></span> -->
              <h3>Personal Information</h3>
            </div>

            <div class="inner-box">

              <div class="only-feilds">
                <!-- input field column class used when we want to show 3 div in one row -->
                <div class="input-feild-columns ">
                  <div class="form-group" [class.error]='showErrors && userEditForm.get("firstName")?.invalid'
                    (click)="firstNameInputBox.focus()">

                    <div class="input-wrapper lg">
                      <input #inputElement #firstNameInputBox type="text" id="firstName" formControlName="firstName"
                        placeholder=" " [class.filled]="userEditForm.get('firstName')?.value" />
                      <label for="firstName" class="floating-label">First Name: <span class="required">*</span></label>
                    </div>

                    @if (showErrors && userEditForm.get("firstName")?.invalid) {
                    <p class="error-message">Please enter first name.</p>
                    }
                  </div>
                  <div class="form-group" [class.error]='showErrors && userEditForm.get("lastName")?.invalid'
                    (click)="lastNameInputBox.focus()">

                    <div class="input-wrapper lg">
                      <input #inputElement #lastNameInputBox type="text" id="lastName" formControlName="lastName"
                        placeholder=" " [class.filled]="userEditForm.get('lastName')?.value" />
                      <label for="lastName" class="floating-label">Last Name: <span class="required">*</span></label>
                    </div>

                    @if (showErrors && userEditForm.get("lastName")?.invalid) {
                    <p class="error-message">Please enter last name.</p>
                    }
                  </div>

                  <div class="form-group" [class.error]='showErrors && userEditForm.get("email")?.invalid'
                    (click)="emailInputBox.focus()">

                    <div class="input-wrapper lg">
                      <input #inputElement #emailInputBox type="text" id="email" formControlName="email"
                        [disabled]="userId ? true : false" placeholder=" "
                        [class.filled]="userEditForm.get('email')?.value" />
                      <label for="email" class="floating-label">Email: <span class="required">*</span></label>
                    </div>
                    @if (showErrors && userEditForm.get("email")?.invalid) {
                    @if (userEditForm.get("email")?.errors?.["required"]) {
                    <p class="error-message">Please enter email.</p>
                    } @else if (email?.errors?.["emailTaken"]) {
                    <p class="error-message">Email already exists.</p>
                    } @else if (userEditForm.get("email")?.errors?.["email"]) {
                    <p class="error-message">Please enter a valid email address.</p>
                    }
                    }
                  </div>
                  @if (userId) {
                  <div class="form-group" (click)="toggleCheckbox('isActive')"
                    [class.error]='showErrors && userEditForm.get("isActive")?.invalid'>
                    <div class="input-wrapper lg">
                      <div class="switch-label">
                        <label for="isActive" class="floating-label"
                          [class.active]="userEditForm.get('isActive')?.value !== null">
                          Status:<span class="important">*</span>
                        </label>

                        <p class="toggle-text">
                          {{userEditForm.get("isActive")?.value ? "Active" : "Inactive"}}
                        </p>

                        <div class="switchBox">
                          <label class="switch">
                            <input type="checkbox" id="isActive" formControlName="isActive" class="toggle-input" />
                            <span class="slider" (click)="toggleCheckbox('isActive')"></span>
                          </label>
                        </div>
                      </div>
                    </div>
                    @if (showErrors && userEditForm.get("sortOrder")?.invalid) {
                    <p class="error-message">Check if user is active or not.</p>
                    }
                  </div>
                  }
                </div>
              </div>
            </div>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>